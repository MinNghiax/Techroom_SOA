<div class="chat-toggle" (click)="toggleChat()" [class.hide]="showChat">
  <img src="assets/img/chatbot-logo.png" alt="Chat" onerror="this.src='https://cdn-icons-png.flaticon.com/512/8943/8943377.png'">
  <div class="tooltip-msg" *ngIf="!showChat">Chat v·ªõi TechRoom! üëã</div>
</div>

<div class="chat-window user-form" *ngIf="showChat && showForm">
  <div class="chat-header">
    <div class="header-info">
      <img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png" alt="Bot">
      <span>Ch√†o kh√°ch m·ªõi!</span>
    </div>
    <button class="close-btn" (click)="toggleChat()">&times;</button>
  </div>
  <div class="form-body">
    <p>Vui l√≤ng cho TechRoom xin th√¥ng tin ƒë·ªÉ ti·ªán x∆∞ng h√¥ v√† h·ªó tr·ª£ ·∫°:</p>
    <div class="input-group">
      <label>H·ªç v√† t√™n</label>
      <input [(ngModel)]="userName">
    </div>
    <div class="input-group">
      <label>S·ªë ƒëi·ªán tho·∫°i</label>
      <input [(ngModel)]="userPhone">
    </div>
    <button class="start-btn" (click)="submitUserInfo()">B·∫Øt ƒë·∫ßu Chat</button>
  </div>
</div>

<div class="chat-window" *ngIf="showChat && !showForm">
  <div class="chat-header">
    <div class="header-info">
      <img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png" alt="Bot">
      <div class="status">
        <span class="name">TechRoom AI</span>
        <span class="online">‚óè ƒêang ho·∫°t ƒë·ªông</span>
      </div>
    </div>
    <button class="close-btn" (click)="toggleChat()">&times;</button>
  </div>

  <div class="chat-body" #chatBody>
    <div *ngFor="let msg of messages" class="message-row" [ngClass]="msg.from">
      <div class="avatar" *ngIf="msg.from === 'bot'">
        <img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png">
      </div>
      <div class="message-bubble" [innerHTML]="msg.text"></div>
    </div>
    
    <div class="message-row bot" *ngIf="isLoading">
      <div class="avatar"><img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png"></div>
      <div class="message-bubble typing">
        <span></span><span></span><span></span>
      </div>
    </div>
  </div>

  <div class="chat-footer">
    <div class="suggestions" *ngIf="showSuggestions">
      <button *ngFor="let chip of suggestionChips" (click)="selectSuggestion(chip)">{{chip}}</button>
    </div>
    <div class="input-area">
      <input [(ngModel)]="inputText" (keydown.enter)="sendMessage()" placeholder="Nh·∫≠p c√¢u h·ªèi...">
      <button (click)="sendMessage()" [disabled]="isLoading || !inputText.trim()">
        <i class="bi bi-send-fill"></i>
      </button>
    </div>
  </div>
</div>