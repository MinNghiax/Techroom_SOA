$primary: #2563eb;
$bg-user: #eff6ff;
$bg-bot: #f3f4f6;

.chat-toggle {
  position: fixed; bottom: 20px; right: 20px; z-index: 10000;
  width: 60px; height: 60px;
  background: white; border-radius: 50%;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: transform 0.2s;

  img { width: 40px; height: 40px; }
  &:hover { transform: scale(1.1); }
  &.hide { display: none; }

  .tooltip-msg {
    position: absolute; right: 70px; top: 15px;
    background: #1e293b; color: white; padding: 6px 12px;
    border-radius: 8px; font-size: 0.85rem; white-space: nowrap;
    &::after {
      content: ''; position: absolute; right: -6px; top: 50%;
      transform: translateY(-50%);
      border-width: 6px 0 6px 6px; border-style: solid;
      border-color: transparent transparent transparent #1e293b;
    }
  }
}

.chat-window {
  position: fixed; bottom: 90px; right: 20px; z-index: 10000;
  width: 380px; height: 550px;
  background: white; border-radius: 16px;
  box-shadow: 0 5px 25px rgba(0,0,0,0.15);
  display: flex; flex-direction: column; overflow: hidden;
  font-family: 'Segoe UI', sans-serif;
  animation: slideUp 0.3s ease-out;

  @media (max-width: 480px) {
    width: 90%; right: 5%; bottom: 20px; height: 80vh;
  }

  .chat-header {
    background: linear-gradient(135deg, $primary, #4f46e5);
    color: white; padding: 15px;
    display: flex; justify-content: space-between; align-items: center;

    .header-info {
      display: flex; align-items: center; gap: 10px;
      img { width: 32px; height: 32px; background: white; border-radius: 50%; padding: 2px; }
      .status {
        display: flex; flex-direction: column;
        .name { font-weight: 700; font-size: 1rem; }
        .online { font-size: 0.75rem; opacity: 0.9; }
      }
    }
    .close-btn { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
  }

  /* User Form Style */
  &.user-form {
    height: auto;
    .form-body {
      padding: 20px;
      p { margin-bottom: 15px; color: #4b5563; font-size: 0.9rem; }
      .input-group {
        margin-bottom: 15px;
        label { display: block; font-weight: 600; margin-bottom: 5px; font-size: 0.9rem; }
        input {
          width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 8px; outline: none;
          &:focus { border-color: $primary; }
        }
      }
      .start-btn {
        width: 100%; padding: 10px; background: $primary; color: white;
        border: none; border-radius: 8px; font-weight: 600; cursor: pointer;
        &:hover { background: darken($primary, 5%); }
      }
    }
  }

  .chat-body {
    flex: 1; overflow-y: auto; padding: 15px; background: #fff;
    display: flex; flex-direction: column; gap: 15px;

    .message-row {
      display: flex; align-items: flex-end; gap: 8px;
      
      .avatar img { width: 28px; height: 28px; border-radius: 50%; }
      .message-bubble {
        padding: 10px 14px; border-radius: 12px; font-size: 0.9rem; line-height: 1.4;
        max-width: 80%; word-wrap: break-word;
        a { color: $primary; font-weight: 600; }
      }

      &.bot {
        .message-bubble { background: $bg-bot; color: #1f2937; border-bottom-left-radius: 2px; }
      }
      
      &.user {
        flex-direction: row-reverse;
        .message-bubble { background: $primary; color: white; border-bottom-right-radius: 2px; }
      }
    }

    .typing span {
      display: inline-block; width: 6px; height: 6px; background: #9ca3af;
      border-radius: 50%; margin: 0 2px; animation: bounce 1s infinite;
      &:nth-child(2) { animation-delay: 0.2s; }
      &:nth-child(3) { animation-delay: 0.4s; }
    }
  }

  .chat-footer {
    padding: 10px; border-top: 1px solid #f3f4f6;
    
    .suggestions {
      display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px;
      &::-webkit-scrollbar { height: 4px; }
      button {
        white-space: nowrap; padding: 6px 12px; border: 1px solid #e5e7eb;
        background: white; border-radius: 20px; color: #4b5563; font-size: 0.8rem;
        cursor: pointer; transition: 0.2s;
        &:hover { border-color: $primary; color: $primary; background: #eff6ff; }
      }
    }

    .input-area {
      display: flex; gap: 8px;
      input {
        flex: 1; padding: 10px 15px; border: 1px solid #e5e7eb; border-radius: 25px; outline: none;
        &:focus { border-color: $primary; }
      }
      button {
        width: 40px; height: 40px; border-radius: 50%; border: none;
        background: $primary; color: white; cursor: pointer;
        display: flex; align-items: center; justify-content: center;
        &:disabled { opacity: 0.6; cursor: not-allowed; }
        i { font-size: 1rem; }
      }
    }
  }
}

@keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }