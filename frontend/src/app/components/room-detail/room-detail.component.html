<div class="container" *ngIf="room">
  <div class="main-layout">
    <div class="content-column">
      <div class="gallery">
        <img [src]="getImgUrl(room.imageUrls[0])" class="main-img" *ngIf="room.imageUrls && room.imageUrls.length > 0">
        <div class="thumb-grid" *ngIf="room.imageUrls && room.imageUrls.length > 1">
          <img *ngFor="let img of room.imageUrls | slice:1" [src]="getImgUrl(img)">
        </div>
      </div>

      <div class="info-section">
        <div class="badge">{{ room.buildingName }}</div>
        <h1>{{ room.name }}</h1>
        <p class="location"><i class="icon-pin"></i> {{ room.address }}</p>
        
        <div class="specs">
          <div class="spec-item"><span>Diện tích</span> <strong>{{ room.area }} m²</strong></div>
          <div class="spec-item">
            <span>Trạng thái</span> 
            <strong [class]="room.status.toLowerCase()">
              {{ room.status === 'AVAILABLE' ? 'Còn trống' : (room.status === 'OCCUPIED' ? 'Đã thuê' : 'Đang sửa') }}
            </strong>
          </div>
        </div>

        <div class="description">
          <h3>Mô tả chi tiết</h3>
          <p>{{ room.description || 'Chưa có mô tả chi tiết cho phòng này.' }}</p>
        </div>

        <div class="amenities">
          <h3>Tiện ích</h3>
          <ul *ngIf="room.amenities && room.amenities.length > 0">
            <li *ngFor="let am of room.amenities">{{ am.name }}</li>
          </ul>
          <p *ngIf="!room.amenities || room.amenities.length === 0">Không có tiện ích đi kèm.</p>
        </div>
      </div>

      <div class="review-section">
        <app-review 
          [roomId]="room.id" 
          [reviews]="reviews" 
          (reviewAdded)="loadReviews(room.id)">
        </app-review>
      </div>
    </div>

    <div class="sidebar-column">
      <div class="sticky-card">
        <div class="price-box">
          <span class="price">{{ room.price | currency:'VND':'symbol':'1.0-0' }}</span>/tháng
        </div>
        
        <button class="btn-open-booking" (click)="toggleBookingForm()" *ngIf="room.status === 'AVAILABLE'">
          Thuê phòng ngay
        </button>
        <button class="btn-disabled" *ngIf="room.status !== 'AVAILABLE'" disabled>
          Phòng đã được thuê
        </button>
      </div>
    </div>

    <div class="booking-modal-overlay" *ngIf="showBookingForm" (click)="toggleBookingForm()">
      <div class="booking-modal-content" (click)="$event.stopPropagation()">
        <button class="modal-close-x" (click)="toggleBookingForm()">&times;</button>
        
        <app-booking-form 
          [roomInfo]="room" 
          (bookingSuccess)="onBookingSuccess()">
        </app-booking-form>
      </div>
    </div>
  </div>
</div>