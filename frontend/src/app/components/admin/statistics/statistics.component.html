<div class="stats-wrapper">
  <header class="stats-header">
    <div class="title-box">
      <h1>Tổng quan hệ thống</h1>
      <p>Số liệu hôm nay</p>
    </div>
    <button class="btn-refresh-text" (click)="fetchData()">
      <i class="bi bi-arrow-clockwise"></i> Cập nhật
    </button>
  </header>

  @if (isLoading) {
    <div class="loading-container">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2">Đang tải dữ liệu...</p>
    </div>
  } @else {
    
    <div class="stats-grid">
      <div class="stat-card blue">
        <div class="card-icon"><i class="bi bi-people-fill"></i></div>
        <div class="card-info">
          <span class="card-label">Tổng thành viên</span>
          <div class="card-value">{{ stats.total }}</div>
          <div class="card-footer">Người dùng</div>
        </div>
      </div>

      <div class="stat-card green">
        <div class="card-icon"><i class="bi bi-cash-stack"></i></div>
        <div class="card-info">
          <span class="card-label">Doanh thu</span>
          <div class="card-value">{{ formatCurrency(stats.totalRevenue) }}</div> <div class="card-footer">Ước tính</div>
        </div>
      </div>

      <div class="stat-card purple">
        <div class="card-icon"><i class="bi bi-houses-fill"></i></div>
        <div class="card-info">
          <span class="card-label">Tổng số phòng</span>
          <div class="card-value">{{ stats.totalRooms }}</div>
          <div class="card-footer">Phòng trọ</div>
        </div>
      </div>

      <div class="stat-card orange">
        <div class="card-icon"><i class="bi bi-person-badge-fill"></i></div>
        <div class="card-info">
          <span class="card-label">Đối tác</span>
          <div class="card-value">{{ stats.landlords }}</div>
          <div class="card-footer">Chủ trọ</div>
        </div>
      </div>
    </div>

    <div class="charts-row">
      <div class="chart-box main-chart">
        <div class="box-header">
          <h3>Tăng trưởng người dùng</h3>
        </div>
        <div class="chart-container">
          <canvas id="userGrowthChart"></canvas>
        </div>
      </div>

      <div class="chart-box side-chart">
        <div class="box-header">
          <h3>Trạng thái phòng</h3>
        </div>
        <div class="chart-container doughnut-container">
          <canvas id="roomStatusChart"></canvas>
        </div>
        <div class="custom-legend">
          <div class="item"><span class="dot blue"></span>Đã thuê</div>
          <div class="item"><span class="dot green"></span>Còn trống</div>
          <div class="item"><span class="dot orange"></span>Bảo trì</div>
        </div>
      </div>
    </div>
  }
</div>